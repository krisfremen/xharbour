/*
 * $Id: ChangeLog,v 1.346 2002/08/13 02:25:04 horacioroldan Exp $
 */

/* Use this format for the entry headers:
   YYYY-MM-DD HH:MM UTC[-|+]hhmm Your Full Name <your_email@address>
   For example:
   2002-12-01 23:12 UTC+0100 Foo Bar <foo.bar@foobar.org>
*/

2002-08-13 18:14 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/vm/hvm.c
    ! Fixed hb_vmInc() hb_vmDec() hb_vmPlus() and hb_vmMinus() support for String[] plus/minus numeric.

2002-08-12 23:25 UTC-0300 Horacio Roldan <harbour_ar@yahoo.com.ar>
   * source/rdd/dbfcdx/dbfcdx1.c
     ! fixed seek bug when having an empty scope
     ! Memo Limit is > 64K now up to 2GB (2^31 or max(long))
     ! fixed bug in ordNumber()

2002-08-11 20:20 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/vm/hvm.c
    ! Fixed typo in hb_vmDec() which broke DATE--.

2002-08-10 22:00 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/pp/ppcore.c
    + Added support for #un[x]command and #un[x]translate
    /* In order for the #command or #translate to be removed, it has to exactly matched with the #un* definition! */

2002-08-10 21:02 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/vm/hvm.c
    ! Fixed hb_vmInc() and hb_vmDec() support of DATE++ and DATE--.

2002-08-09 14:50 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * source/rtl/achoice.prg
    % Fixed Bug when nRight parameters is 79. When column 79 is used ,ie:achoice(00,00,24,79,aPesquisa), browsing an
     large array back make the display slower Reported by an Brazilian user

2002-08-09 09:48 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * include/hbapi.h
    + Added HB_IS_NUMBER() only matches numbers vs. HB_IS_NUMERIC() which also matches HB_IT_DATE and HB_IT_STRING[].

  * source/vm/hvm.c
    ! Fixed hb_vmPlus() to correctly return date when one of the operands is a DATE and the other is a NUMBER.
    ! Fixed hb_vmPlus() to correctly return date when one of the operands is a DATE and the other is a DATE (like Clipper).
    ! Fixed hb_vmMinus() to correctly return date when the left operand is a DATE and the right operand is a NUMBER.

  * include/hbexprb.c
    + Added HB_P_ADDINT optimization to HB_P_MINUS
      /* Minus operations involving an integer will now be many times faster. */

  * source/rtl/win32ole.prg
  * tests/testole.prg
    * Renamed GetObject() to GetActiveObject() to avoid conflict with WINAPI GetObject()

2002-08-09 01:25 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/rtl/win32ole.prg
    ! Finished implementation of GetObject()

  * tests/testole.prg
    * Modified demo to demonstrate usage of GetObject()

2002-08-08 12:30 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * include/hbapi.h
    * Modified HB_IS_NUMERIC() to accept HB_IT_DATE and HB_IT_STRING (length 1).

  * source/vm/hvm.c
    - Removed no longer needed hb_vmPopDate().
    + Added support for HB_IT_DATE and HB_IT_STRING[] in hb_vmPopNumber() and hb_vmPopDouble().
    - Removed explicit logic supporting DATE and STRING[] from math and comparisons opertations.
    * Completed support for DATE and STRING[] in ?all? numeric contexts.

  * source/vm/itemapi.c
    + Added support for HB_IT_STRING and HB_IT_DATE in hb_itemGetN*()

  * source/rdd/dbf1.c
  * source/rtl/minmax.c
  * source/rtl/transfrm.c
  * source/vm/arrays.c
    * Changed order of type checking so HB_IS_DATE() and HB_IS_STRING() precede HB_IS_NUMERIC() because DATE and STRING may also be NUMERIC.

  /*
     HBTEST "errors" increased by 2 (to 107 in BCC 5.5), but that only because of
     Clipper not correctly supporting DATE types in Max() and Min().
     These are NOT errors but actually the correct behaviour.
  */

2002-08-08 00:40 UTC-0300 Horacio Roldan <harbour_ar@yahoo.com.ar>
   * source/rdd/dbcmd.c
   * source/rdd/dbf1.c
     ! minor change to previous fix in dbCloseArea

2002-08-07 21:00 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
   * utils/hbmake/hbmake.prg
     % fixed minor problems reported by users

2002-08-07 17:58 UTC-0300 Horacio Roldan <harbour_ar@yahoo.com.ar>
   * include/hbapirdd.h
   * source/rdd/dbcmd.c
   * source/rdd/workarea.c
     ! fixed gpf in dbCloseArea, now relations are
       closed if child area is closed, reported by Brian Hays

2002-08-07 16:20 UTC-0300 Horacio Roldan <harbour_ar@yahoo.com.ar>
   * source/rdd/dbf1.c
     ! added os error code, for neterr() support
       and temporary fix for Win/DOS platforms.

2002-08-06 19:45 UTC+0100 Marek Paliwoda <paliwoda@inetia.pl>
  * source/rtl/gtsln/gtsln.c
    * Fixed screen flushing when cursor is off-screen

2002-08-05 23:38 UTC-0300 Horacio Roldan <harbour_ar@yahoo.com.ar>

   * source/rdd/dbcmd.c
        ! fix GPF in dbCloseAll, reported by Jorge Mason

2002-08-05 11:03 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/rtl/cstruct.prg
    * Minor trace info.
  * source/vm/arrayshb.c
    ! Fixed type in HB_FUNC( HB_SIZEOFCSTRUCTURE ) which caused the alingment to always be 4, regardless of passed paramater.
    ! Fixed few compiler warnings regarding using NULL as a 0.

  * source/rtl/win32ole.prg
  * tests/testole.prg
    + Added work in progress implementation of GetObject()

2002-08-02 19:30 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  *source/rtl/set.c
    Sync with harbour with follow change
      2002-08-02 12:05 UTC-0400 David G. Holm <dholm@jsd-llc.com>
        * source/rtl/set.c
         ! When encountering SET ALTERNATE TO, close the file.
         ! When encountering SET(_SET_EXTRAFILE,NIL), close the file.

2002-07-30 11:06 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/vm/classes.c
    * Reverted "Multplication Method" to "Division Method" due to amplification of tendancy in MsgToNum()
    * More reasonable initial allocation for inherted classes too.

  * source/vm/arrayshb.c
    + Added <lAdopt> optional 4th parameter to HB_StructureToArray() indicating wether memory pointed to
      by nested pointers should be adopted by the created members. Default is .F.
    + Added <bAdopt> optional 4th parameter to StructureToArray() indicating wether memory pointed to
      by nested pointers should be adopted by the created members. Default is FALSE.

  * source/rtl/cstruct.prg
    + Added <lAdopt> optional 2nd. parameter to :Buffer() Method, indicating wether memory pointed to
      by nested pointers should be adopted by the created members. Default is .F.
    + Added <lAdopt> optional parameter to :DeValue() Method, indicating wether memory pointed to
      by nested pointers should be adopted by the created members. Default is .F.
    + Added <lAdopt> optional 2nd. parameter to :Pointer() Method, indicating wether memory pointed to
      by nested pointers should be adopted by the created members. Default is .F.

  * tests/tstcstru.prg
    * Added .T. as 2nd. parameter to Buffer() method call to demonstrate how to adopt the memory allocated from C.

  * doc/cstruct.txt
    * Updated documentation.

  * source/vm/fm.c
    * Minor modification to error message.

2002-07-29 23:58 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/rtl/cstruct.prg
    * Minor modification of Array Structure member names.

  * source/vm/classes.c
    * Changed __ClsNew() to receive additional 3rd parameter indicating the Number of additional messages (other than datas)
      pushing subsequent optional Parent to be 4th paramater.
    * __ClsNew() will now pre allocate a more reasonable initial size to ->pMethods based on class definition.
    - Removed hb_cls_MsgToNum()
    * Modified hb_cls_MsgToNum() calls to MsgToNum()
    * Modified MsgToNum() to use "Multiplication Method" instead of "Division Method" as per suggestion in
      "Mastering Algorithms with C" Pg. 145 - This produces a more consistent distribution over a table of NON prime size.
    * Reverted doubling size logic in recent change to hb_clsDictRealloc().

  * source/rtl/tclass.prg
    + Added 3rd paramater to __ClsNew() calls.

  /* J.F., can you please review these changes... */

2002-07-29 10:34 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/vm/classes.c
    * Imporoved hb_clsDictRealloc() allocation logic.

2002-07-27 16:10 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/vm/arrayshb.c
    + Added support for NIL to be compatible with ALL C TYPES.

  * source/rtl/cstruct.prg
    + Added logic to raise an error in HB_CStructureCSyntax() if member type is undefined.

  * tests/wintypes.ch
    + Added LPSTR and HBITMAP

2002-07-26 02:31 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/vm/hvm.c
    * Minor optimization in hb_vmFuncPtr()

2002-07-25 11:18 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/common/expropt1.c
    ! Fixed memory leak in optimization of empty array.

2002-07-24 11:40 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * doc/cstruct.txt
  * include/cstruct.ch
    * Added: IMPORT C STRUCTURE <strucName>. This allows usage of structures from a separately compiled modules.

2002-07-25 11:45 UTC-0300 Walter Negro <anegro@overnet.com.ar>
  * source/rtl/transfrm.c
    ! Fix minor bug in declaration of var.

    Reported by Ron Pinkas

2002-07-23 20:21 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/vm/arrayshb.c
  * source/vm/classes.c
    ! Corrected few compiler warnings.

2002-07-23 19:56 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * include/hbapi.h
  * source/vm/dynsym.c
    * Changed hb_dynsymEval( PHB_DYNS_FUNC pFunction, void * Cargo ) to return USHORT position of last scanned symbol.
    + PHB_DYNS hb_dynsymFindFromFunction( PHB_FUNC pFunc ); /* returns a dynamic symbol for a given function pointer. */
    + PHB_DYNS hb_dynsymPos( USHORT uiPos ); /* returns a dynamic symbol from a position index. */

  * source/vm/classes.c
    + PHB_DYNS hb_clsSymbolFromFunction( PHB_ITEM pObject, PHB_FUNC pFunction )
    + HB_ObjMsgPtr( oObj, cMessage ) -> nFuncPointer

  * source/vm/hvm.c
    + HB_Exec( nFuncPointer [, oSelf] [, xParam1 ] [, xParamN ] ... )

  + tests/testexec.prg
    + New test to demonstrate HB_FuncPtr(), HB_ObjMsgPtr(), HB_Exec()

2002-07-23 11:56 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * include/hbexprb.c
    ! Fixed memory leak in macro compiler related to optimizations of SubStr(), Right(), and aTail().

2002-07-23 10:35 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/rtl/cstruct.prg
    * Improved Hb_Member() to support expressions within [], like: BYTE[ SOME_LEN + 1 ]
    + Added Method Pointer( [nNewPointer] ) -> nPointer

  * source/rtl/str.c
    + Added HB_String2Pointer( cString ) -> nPointer
    + Added HB_Pointer2String( nPointer [, nLen] ) -> cStringBuffer

2002-07-23 00:21 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * include/cstruct.ch
  * source/rtl/cstruct.prg
    % Optimized C Syntax support
    ! Fixed matching of optional tagName.

  * tests/pp.prg
    ! Minor fix to -I switch.

2002-07-23 00:30 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * source/rtl/isprint.c
    ! Minor formating

2002-07-22 18:43 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/rtl/isprint.c
    ! Fixed 2 type errors reported by MSVC.

2002-07-22 18:34 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * include/hbapi.h
    - Removed #define hb_itemArrayPut(...) ...

  * include/hbapiitm.h
  * source/vm/itemapi.c
    + Restored hb_itemArrayPut(...) since some compiled 3rd party code may reference the function.

  * source/rtl/cstruct.prg
    + Added Error handling code to raise standard error on some error conditions.
    + Added logic to correctly handle duplicate definition of C Structure from a seperate module.

  * source/vm/arrayshb.c
    + Added logic to correctly automatically handle conversion from HB_IT_INTEGER, HB_IT_LONG, HB_IT_DOUBLE to sign/unsigned short, int, long [*].

2002-07-18 08:00 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
   * source/rdd/dbf1.c
    ! sync with harbour with follow change
      2002-06-07 13:53 UTC+0300 Alexander Kresin <alex@belacy.belgorod.su>
        * source/rdd/dbf1.c
        ! Bug fixed in hb_dbfLockRecord(), reported by Richard Chidiak

2002-07-17 08:50 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/rtl/idle.c
    + Added missing hb_itemRelease() based on suggestion from Niko Mikkila.
  * tests/testidle.prg
    * Minor revisions

2002-07-17 08:06 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/pp/ppcore.c
    ! Minor fix to NextName() to skip over .T. and .F.
  * source/rtl/win32ole.prg
    ! Minor fix when a type VT_DISPATCH is actually NULL.
    ! Minor fix when converted string (ansi/wide is empty string.

2002-07-17 09:08 UTC-0300 Walter Negro <anegro@overnet.com.ar>
  * source/rtl/tget.prg
    ! Fix initialization ::lEdit in New method.

    Bug and solution reported by Jose F. Gimenez

2002-07-14 13:30 UTC-0300 Walter Negro <anegro@overnet.com.ar>
  * doc/transfrm.txt
    + Add information about new functionalities.

  * doc/tracing.txt
    + Add information about work with DOS/WIN9x.

  * doc/en/var.txt
    + Add information about HB_ISBYREF().

  * source/rtl/tget.prg
    ! Fix and more compliant in Untransform(), PutMask() and KillFocus()
      methods.
    Reported by Andrew Wos

2002-07-13 19:50 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * utils/hbmake/hbmake.prg
   ! Minor changes to Library edit mode. added option to install library on
     xharbour library directory

2002-07-11 11:29 UTC-0300 Walter Negro <anegro@overnet.com.ar>
  * source/vm/itemapi.c
    ! Fix rounded for big numbers ( more of 16 significant numbers ).

2002-07-10 23:55 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  + contrib/rdd_ads/*
    + All files for rdd_ads is now on xharbour repository

2002-07-10 17:12 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * include/hbexprb.c
    ! Added missing break that caused an excess call to HB_XFREE() resulting in error 9022.

2002-07-09 22:00 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * utils/hbmake/hbmake.prg
   ! Fix the determination of Error when compiling C/Cpp sources

2002-07-08 01:40 UTC-0300 Walter Negro <anegro@overnet.com.ar>
  * source/rtl/tget.prg
    ! Fix minor bug in PutMask() method.

      Reported by Luiz Rafael Culik from brazilian user

2002-07-07 23:10 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * utils/hbmake/hbmake.prg
    utils/hbmake/hbmutils.prg
     % compilation of .cpp files is working properly now
     % compilation of .rc files fixed
     * new option to harbour that say to use Fivehx.lib for FWH
     * Added .cpp files for user selection box

2002-07-07 14:00 UTC-0300 Walter Negro <anegro@overnet.com.ar>
  * source/rtl/transfrm.c
    ! Fix with numeric values and pictures with spaces and pictures with
      severals dot.
      The return values are compliant with Clipper.
      eg: Transform( 1234, "9 999" )
      eg: Transform( 123.123456, "999.99.99.99" )

2002-07-05 23:35 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * source/rtl/isprint.c
    * Final Fix for getprinters() function to work properly on WinXP

2002-07-05 12:51 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * bin/bld.bat
    ! Reverted Luiz change of hardcoded paths with relative paths. (Luiz ??? - This wasted an hour of my time!!!)

  * source/vm/hvm.c
    ! Minor fix to hb_vmPushLocalByRef() and hb_vmPushStsticByRef()

  * source/vm/memvars.c
    ! Minor fix to hb_memvarGetRefer()

2002-07-05 12:37 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * include/hbapifs.h
    + Added missing: extern int WintoDosError( unsigned long lError)

  * include/hbsetup.h
    + Added MSVC to compilers enabling HB_OS_WIN_32

  * source/common/hbffind.c
    ! Corrected usage of WintoDosError()

2002-07-03 21:30 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * source/rtl/isprint.c
    * Fixed getprinters() function to work properly on WinXP

2002-07-03 19:10 UTC-0300 Walter Negro <anegro@overnet.com.ar>
  * source/rtl/transfrm.c
    + Add @) template.

    ! Fix @D with numeric expressions.

    ! Fix bug with @D in string expressions.
      eg: Transform( "1", "@D" )
      This example generate an GPF or strange memory errors.

    ! Better support for mask with initial comma, period or space.

    ! Better support for later mask.

    ! Replace comma, period or the correspondient space with an '*'
      when previous character is '*' too.
      eg: Transform( 99999, "9.999" ) -> Before: "* ***" Now: "*****"
          Transform(    99, "*.***" ) -> Before: "* *99" Now: "***99"

    * More compliant, resolve several hbtest errors.

  * source/rtl/tgetlist.prg
    * Detection of modification with direct access to the var get in
      preval, postval and setkey functions.

      Point of control: GetPreValidate(), GetPostValidate(),
                        GUIGetPreValidate(), GUIGetPostValidate(),
                        GetDoSetKey().

  * source/rtl/tget.prg
    + Add two protected methods. FirstEditable() and LastEditable().
      Several change for use this methods.

    ! Fix in ParsePict method
      * @D function, overwrite the mask for SET DATE FORMAT
      * @S without lenght parameter or @S0, they don't have effect.

    ! Fix in Untransform method
      * if ::lEdit is false, return ::VarGet() without evaluate
        the buffer contained.
      * Better detection of a negative, minimizing false detections.
      * Improvement in the handling of mask.
      * More compliant in @D, @E, @X, @C, @(, @) functions.
      * In compliant with Clipper, the lenght of number (internal lenght)
        corresponds to the applied picture.
      ! Bug in conversion with date types and with @E function.

    ! Fix in Overstrike and Insert method
      * First it is evaluated if the input character is valid, before
        cleaning the var.

    ! Fix in Input method
      * The minus sign can be writed in any place.
      * Now work with '$' and '*' templates in numeric gets.

    ! Fix in PutMask method
      * More compliant in the handling of some get functions.
      * When edit a get with @B, the number is editing right-justified.

    ! Fix in Backspace method
      * Permit delete a '(' symbol in a non-editable position, when
        this symbol represent a negative number.

    ! Fix in Delete method
      ! When delete a negative symbol '(' or '-', turn the ::minus tu false

    ! Fix in IsBadDate function
      ! Evaluate correctly a date with @E function.

  * source/rtl/dates.c
    * More compliant for certain strange formats. eg: DD/MMM/YYYY

2002-07-02 10:20 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * source/rtl/filesys.c
    source/common/hbffind.c
    ! Fixed Error values for djgpp(Djgpp error.h values is diferent from other C compilers)
  * utils/hbtest/rt_file.prg
    * Fixed the test for File( cFileName ), The file exist when this test is done, so i've correct the error value

2002-06-30 17:00 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  + contrib/hbzlib/*.*
    + Added all files need to build hbzlib and zlib

2002-06-29 09:55 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * source/rtl/gtsln/gtsln.c
    ! Reverted back to previus version since this syncro was not needed

2002-06-29 00:02 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * source/rtl/set.c
    ! Fixed Minor Bug that was preventing the use of the printer Again
    when Using  Set(24,"win:"xxx)
 * utils/hbmake/hbmake.prg
    ! Changed temporary file name from makefile.tmp makefile.lnk
  *Sync Xharbour with this last changes of Harbour(With date)
2002-06-28 10:43 UTC+0300 Alexander Kresin <alex@belacy.belgorod.su>
  * source/rdd/dbfntx/dbfntx1.c
    ! Bug fixed in hb_ntxPageSplit() - the created page was not released.

2002-06-27 15:25 UTC-0400 David G. Holm <dholm@jsd-llc.com>
  * source/rtl/gtsln/gtsln.c
    ! HRBNATIONCHARS fix provided by Niko Mikkila <nm@phnet.fi>

2002-06-27 22:30 UTC+0300 Alexander Kresin <alex@belacy.belgorod.su>
  * source/rdd/workarea.c
    ! Bug fixed in hb_waSetRel(), reported by Richard  Chidiak

2002-06-26 18:41 UTC+0100 Ignacio Ortiz <ignacio@fivetech.com>
  * source/rtl/tget.prg
    !Fixed minus property value, did not work correctly


2002-06-25 09:00 UTC-0800 Ron Pinkas <ron@ronpinkas.com>
  * source/compiler/harbour.slx
    ! Fixed handling of TEXT as IDENTIFIER.

2002-06-25 09:25 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * source/rdd/dbfntx/dbfntx1.c
   * Added the xharbour Pcode signature(missed in previus post)

2002-06-24 21:25 UTC-0300 Luiz Rafael Culik <culikr@uol.com.br>
  * source/rtl/tget.prg
   source/rdd/dbcmd.c
   source/rdd/dbfntx/dbfntx1.c
    * Sync with Harbour
 * Changelog renamed to Changelog.013 and started an new one


