/*
 * $Id: ChangeLog,v 1.5532 2007/05/17 05:01:44 ronpinkas Exp $
 */

/* Use this format for the entry headers:
   YYYY-MM-DD HH:MM UTC[-|+]hhmm Your Full Name <your_email@address>
   For example:
   2002-12-01 23:12 UTC+0100 Foo Bar <foo.bar@foobar.org>
*/

2007-05-18 00:07 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * include/adordd.ch
  * source/rdd/usrrdd/rdds/adordd.prg
     + ADO_FIELDINFO( nWA, nField, nInfoType, uInfo )  added
     * ADO_OPEN( nWA, aOpenInfo )                      modifications reported by Fernando Athayde
     * ADO_GETVALUE( nWA, nField, xValue )             modifications reported by Fernando Athayde

2007-05-17 00:58 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/classes.h
     + Re-added hb_objGetClass() for Harbour compatability
  * source/vm/classes.c
    * Trace info for debug of class dictionary guarded by #if 0
      /* Walter this is what I used to trace the Message not found TClipGet:VarGet problem */

2007-05-17 00:41 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/compiler/harbour.c
    * More memory leaks - work in progress

2007-05-16 23:40 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * make_b32.bat
    * Should not remove map and tds file after sucessful build
  * include/simplex.c
    * Typo in last commit which caused bad leak

2007-05-16 13:50 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/compiler/harbour.sly
    * Minor formatting
  * source/compiler/harbour.c
    * More memory leaks - work in progress

2007-05-16 10:53 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/compiler/harbour.c
    * Memory leak

2007-05-16 10:29 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/simplex.c
    * Minor trap

2007-05-16 13:00 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * include/adordd.ch
  * source/rdd/usrrdd/rdds/adordd.prg
     * Syntax corrections.

2007-05-16 01:15 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/simplex.c
    * Correction to recent commit

2007-05-15 17:31 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbapi.h
  * source/pp/ppgen.c
  * source/vm/fm.c
  * utils/hbpp/hbpp.c
  * include/hbexprc.c
  * source/macro/macro.y
  * source/compiler/harbour.c
    + Allow to redirect hb_xgrab(), hb_xalloc(), hb_xrealloc(), hb_xfree(0

  * include/simplex.c
  * source/compiler/harbour.slx
  * source/compiler/harbour.sly
    ! Fixed some memory leaks - work in progress

  * source/compiler/genc.c
    ! Fixed GPF trap

2007-05-15 12:30 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/browse.prg
  * source/rtl/tbrowse.prg
    ! fixed to improve performance under index operation.
      Thanks to Mario H.Sabado and Eduardo Horbino by help.

2007-05-15 12:40 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/eval.c
    * Fixed loop "optimisations" that cause bugs, reported by Mindaugas
  * source/vm/hvm.c
    * Fixed loop "optimisations" that cause bugs, reported by Mindaugas
  * source/vm/dynsym.c
    * Change USHORT to UINT in return functions
    * hb_dynsymEval() and hb_dynsymCount()
  * include/hbapi.h
    * Change USHORT to UINT in return functions
    * hb_dynsymEval() and hb_dynsymCount()

2007-05-14 21:25 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/vm/arrays.c
    * Corrected typo in hb_arrayScan() when scanning HB_IT_HASH

2007-05-14 18:15 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/pp/ppcore.c
    * Minor correction to Extended Blocks support

2007-05-14 17:02 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/vm/arrays.c
    * Reset of type when placing a memo field into array

2007-05-13 21:25 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/vm/hvm.c
  * source/vm/memvars.c
    * Reset of type when copying a memo field to memvar and array

2007-05-12 15:30 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/compiler/hbfix.c
    ! Corrected some local near optimizations which were not excluding detached locals, and were not using HB_LIM_INT8()
    /* All prg sources must be recompiled to correct compilation of detached locals operations in codeblocks */

  * source/pp/ppcore.c
    ! Fixed wild match marker support of literal ';'

2007-05-11 19:45 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/pp/ppcore.c
    * Added Extended Codeblock support to Blockify

2007-05-11 18:50 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/pp/ppcore.c
    * Minor correction to Extended Codeblock support

2007-05-11 18:15 UTC+0100 Hannes Ziegler <hz@knowleXbase.com>
    + added HTML classes and functions
      see source\tip\changelog

    + tests\tiptest\loadhtml.prg
    + tests\tiptest\dbtohtml.prg

2007-05-11 11:35 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/classex.ch
    ! Fixed to work with new PP

2007-05-11 10:00 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/eval.c
    * Minor optimizations
    * Fix my mistake at line 187, uiParam count LEN to 0 (Thanks Toninho!)

2007-05-11 13:00 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * include/adordd.ch
  * include/usrrdd.ch
  * source/rdd/usrrdd/rdds/adordd.prg
    + Added FireBird support
    + ADO_CLOSE( nWA )
    + ADO_ZAP( nWA )
    * ADO_ORDINFO( nWA, nIndex, aOrderInfo )
    + ADO_RECINFO( nWA, nRecord, nInfoType, uInfo )
    + Added support to new FieldTypes DateTime, TimeStamp, Ole.

  * include/hbdbf.h
    + some comments.

  * include/hbtypes.h
    * corrected definition function. VM_PROCESS_DLL_SYMBOLS
      but is not enougth to execute correctly PCODE in DLL.

2007-05-10 22:00 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbpp.h
  * source/pp/ppcore.c
    * Hack to support Extended Codeblocks as Expressions

  * source/compiler/harbour.c
  * source/compiler/harbour.sly
    * Corrected generation of Extended Codeblocks to use HB_P_FRAME

  * source/vm/memvars.c
    * Silly memory leak, mistake in last commit

2007-05-10 14:40 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/inet.c
    * Minor optimizations

2007-05-10 01:38 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/compiler/genc.c
  * source/compiler/harbour.c
  * source/compiler/harbour.sly
  * source/compiler/hbident.c
    * Work in progress - started cleanup of memory leaks in compiler
      /* Any help will be greatly appreciated. */

2007-05-09 15:51 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbclass.ch
    * Corrected missing space to avoid unintentional concatanation of AS TYPE ...

  * include/hbmemory.ch
  * source/vm/fm.c
    + Added HB_MEM_BLOCKS (tottal numbers of allocated blocks

  * source/vm/memvars.c
    * Fixed memory leak
    * Minor simplifications

2007-05-09 17:00 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
   * contrib/adordd/adordd.prg
     * Improved ADO_CLEARREL()
     * Improved Deleted()
     + Added function HB_AdoRddGetRecordSet( [<nWorkArea>] ) --> oAdoRecordset
     + New functions HB_AdoRddGetConnection( [<nWorkArea>] ) --> oAdoConnection
       and HB_AdoRddGetCatalog( [<nWorkArea>] ) --> oAdoCatalog
     Borrowed from harbour

2007-05-09 11:00 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * source/rdd/userrdd/rdds/adordd.prg
    + added support to all dbf fieldtypes supported in dbf format from xharbour.
      and added support to autoconection for create files .xls and .db

        CASE aStruct[ n ][ DBS_TYPE ] == "V"
             s_aSQLStruct[ nWA ] += " VARCHAR(" + AllTrim( Str( aStruct[ n ][ DBS_LEN ] ) ) + ") NULL"

        CASE aStruct[ n ][ DBS_TYPE ] == "B"
             s_aSQLStruct[ nWA ] += " DOUBLE NULL"

        CASE aStruct[ n ][ DBS_TYPE ] == "Y"
             s_aSQLStruct[ nWA ] += " SMALLINT NULL"

        CASE aStruct[ n ][ DBS_TYPE ] == "I"
             s_aSQLStruct[ nWA ] += " MEDIUMINT NULL"

        CASE aStruct[ n ][ DBS_TYPE ] == "D"
             s_aSQLStruct[ nWA ] += " DATE NULL"

        CASE aStruct[ n ][ DBS_TYPE ] == "T"
             s_aSQLStruct[ nWA ] += " DATETIME NULL"

        CASE aStruct[ n ][ DBS_TYPE ] == "@"
             s_aSQLStruct[ nWA ] += " TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP"

        CASE aStruct[ n ][ DBS_TYPE ] == "M"
             s_aSQLStruct[ nWA ] += " TEXT NULL"

2007-05-08 22:30 UTC-0500 Vicente Guerra <vicente@guerra.com.mx>
  * source/vm/arrays.c
    * Removed "register" type declaration to memory-addressed variable.

2007-05-08 17:00 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/arrays.c
    * Minor optimizations

2007-05-08 07:35 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * source/rtl/tscalar.prg
    ! Fixed Missing Method ARRAY:Init() Lost in the move :)
  * source/rtl/tobject.prg
    - Removed Old Code for HBObject class definition
    - Removed Method New Code
      * Optimized Using   MESSAGE New Is Init

2007-05-08 08:15 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * makefile.pc
    + added adordd.

2007-05-08 12:00 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * include/hbapi.h
  * source/rdd/dbf1.c
  * source/rdd/dbfdbt/dbfdbt1.c
  * source/rdd/dbffpt/dbffpt1.c
  * source/rdd/workarea.c
    + added support to fieldtype G (OLE)
      G  	OLE/General   10 digits (bytes) representing a .DBT block number.
      The number is stored as a string, right justified and padded with blanks.

      (dBASE V: like Memo) OLE Objects in MS Windows versions

      Are pendding to implement FieldGet to autocreate tOleAuto object when is
      required.

  * source/rdd/userrdd/rdds/adordd.prg
    * minor sintax corrections.

2007-05-07 12:00 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/hvm.c
    * Revert, switch hb_vmDo( UINT uiParams ) to hb_vmDo( USHORT uiParams )
    * Changes UINT to short, int and LONG for iJump when negative in JUMPS
    * Fix error in hb_vmCalcIntWidth, hbtest.exe now with 34 failed calls
  * source/vm/itemapi.c
    * Fix warning at line 2167
  * include/hbvm.h
    * Revert, switch hb_vmDo( UINT uiParams ) to hb_vmDo( USHORT uiParams )

2007-05-07 12:05 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * harbour/source/rdd/dbcmd.c
    * initialize lpaParent in DBRELINFO structure to pArea - please
      note that this initialization is ignored by default SETREL()
      RDD method
    Synched with Harbour.

  * harbour/source/rdd/usrrdd/usrrdd.c
    ! fixed GPF when NULL lpaParent or lpaChild was used in DBRELINFO
      structure
    Synched with Harbour.

  + include/adordd.ch
  * makefile.bc
  + source\rdd\usrrdd\rdds\adordd.prg
  + source\rdd\usrrdd\rdds\adordd\access1.prg
  + source\rdd\usrrdd\rdds\adordd\make_b32.bat
  + source\rdd\usrrdd\rdds\adordd\makefile.bc
  + source\rdd\usrrdd\rdds\adordd\mysql1.prg
     +added user rdd ADORDD borrowed from harbour with few changes.
      will be changed in next releases SET FILTER TO to be compatible
      with other workareas which can be using another formats.

  * harbour/source/rdd/wacore.c
  * harbour/include/hbapirdd.h
    * updated HB_TRACE messages and some minor cleanups
    Synched with Harbour.

  * harbour/source/rdd/dbcmd.c
    ! fixed initialisation of DBRELINFO dbSetRelation() - thanks to Antonio
      for locating the problem
    Synched with Harbour.


2007-05-06 00:46 UTC-0500 Vicente Guerra <vicente@guerra.com.mx>
  * source\vm\hvm.c
    ! Fixed (patched?) HB_P_JUMPFALSE, HB_P_JUMPFALSE, HB_P_JUMPFALSEFAR
      HB_P_JUMPTRUENEAR, HB_P_JUMPTRUE, HB_P_JUMPTRUEFAR when it jumps back.

2007-05-04 19:25 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * makefile.pc
  * hrbdll.pc
    + added wacore.c and wafunc.c files
  * source/rtl/tget.prg
    ! fixed bug reported in "@X" and "@C" pictures.

2007-05-03 16:48 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/rdd/usrrdd/usrrdd.c
  * source/rdd/bmdbfcdx/bmdbfcdx1.c
  * source/rdd/dbfcdx/dbfcdx1.c
  * source/rdd/dbfdbt/dbfdbt1.c
  * source/rdd/dbffpt/dbffpt1.c
  * source/rdd/dbfntx/dbfntx1.c
    * Fix hb_rddInherit call ( BYTE * ) to ( const char * )
  * include/hbvmpub.h
    * switch "USHORT uiSymbols" to "UINT uiSymbols" in
    *    hb_vmRegisterSymbols() at line 154
  * include/hbvapi.h
    * switch "char * szName" to "const char * szName" in
      hb_dynsymGet(), hb_dynsymGetCase(), hb_dynsymFind(), hb_dynsymGetSymbol(),
      hb_dynsymFindSymbol() and
      hb_dynsymGet_r(), hb_dynsymGetCase_r(), hb_dynsymFind_r(), hb_dynsymFindName_r()
  * source/vm/hvm.c
    * switch "USHORT uiParams" to "UINT uiParams" in
      hb_vmRegisterSymbols() at line 9247
    * Fix warnings (-Wall)
  * source/vm/itemapi.c
    * Fix warnings (-Wall)
  * source/vm/fastitem.c
    * Fix warnings (-Wall)
  * source/vm/dynsym.c
    * switch "char * szName" to "const char * szName" in
      hb_dynsymGet(), hb_dynsymGetCase(), hb_dynsymFind(), hb_dynsymGetSymbol(),
      hb_dynsymFindSymbol() and
      hb_dynsymGet_r(), hb_dynsymGetCase_r(), hb_dynsymFind_r(), hb_dynsymFindName_r()
    * Fix warnings (-Wall)


  /* Please recompile all "c" sources */


2007-05-04 18:32 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * harbour/source/rdd/dbcmd.c
    * removed all explicit NETERR setting - now it can be set only
      by NETERR() function (executed by default errorsys)
    * changed ordListAdd()/dbSetIndex() - now they return logical value
      with information about success
    Synched with Harbour.

  * harbour/source/rdd/wafunc.c
    * changed hb_rddOpenTable()/hb_rddCreateTable() to make dbUseArea()/
      dbCreate() more Clipper compatible - it's not exact Clipper behavior
      but I intentionally do not want to replicate some strange for me
      things, f.e. I do not know why Clipper ignores RDDNAME when it has
      only one character
    Synched with Harbour.

  + harbour/tests/tstuse.prg
    + test code for dbUseArea()
    Synched with Harbour.

2007-05-04 06:40 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * source/cgi/tcgi.prg
    * Changue __CLS_PARAM TO  {}
  * source/rtl/ttable.prg
    * Changue __CLS_PARAM TO  {}
  * hrbdll.vc
    + Add classesc

2007-05-04 13:04 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * source/rdd/wafunc.c
    * change of the behavior of DbUseArea opening, so that one behaves like made Clipper, when it fails the
      opening of a table, does not recover the previous area.

2007-05-04 13:04 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * hrbdll.bc
  * hrbdll.vc
  * makefile.bc
  * makefile.vc
  * include/hbapirdd.h
  - include/hbrddwrk.h
  * source/rdd/Makefile
  + source/rdd/wacore.c
  + source/rdd/wafunc.c
  * source/rdd/workarea.c
    * cleaned RDD code:
      * the default work area implementation from which each RDD inherits
        and RDD management is now in workarea.c file - this part will be
        common for all threads in future MT version
      * the code to mange workareas and aliases moved to wacore.c - this
        code uses some static variables which will be moved to HVM stack
        in MT version
      * helper RDD functions thread independent moved to wafunc.c
    Synched with Harbour.

  * source/rdd/dbcmd.c
    * removed RDD/WorkArea management code - only independent HB_FUNCs
      left. IMHO it will be good to divide this file into few ones.
    * changed dbCreate() and dbUseArea() to return logical value
      Synched with Harbour.

  * contrib/rdd_ads/ads1.c
  * source/rdd/dbf1.c
  * source/rdd/delim1.c
  * source/rdd/sdf1.c
  * source/rdd/dbfcdx/dbfcdx1.c
  * source/rdd/dbfdbt/dbfdbt1.c
  * source/rdd/dbffpt/dbffpt1.c
  * source/rdd/dbfntx/dbfntx1.c
  * source/rdd/nulsys/nulsys.c
    * updated for recent modifications in RDD API
      Synched with Harbour.

  * include/hbextern.ch
    - removed __RDDSETDEFAULT() - this function was necessary with old
      rdd register code and we not not need it for few years. It's not
      Clipper function so I do not see any reason to keep it but if you
      want we can add wrapper to standard RDDSETDEFAULT()
      Synched with Harbour.

  * source/rdd/hbsix/sxcompr.c
    + added workaround for SIX3 bug which I intentionally replicated in
      [x]Harbour but it may cause data corruption so IMHO it will be better
      to fix it.
      Synched with Harbour.

  * source/rtl/errorsys.prg
    * added default action for EG_LOCK - it's Clipper compatible behavior
      but done in differ way. Due to some differences in linker we are
      using we cannot exactly replicate Clipper behavior because it will
      not work on some platforms as expected so I decided to add it here.
      I think it's even more Clear then the trick with source/sys/ntxerr.prg
      done by Clipper. Many people do not even knows about it.

2007-05-03 18:40 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * include/hbvm.h
    * switch hb_vmDo( USHORT uiParams ) to hb_vmDo( UINT uiParams )
  * include/hbvmpub.h
    * switch USHORT to UINT in
    *   struct SYMBOLS (line 140)
    *   struct hb_struDouble (lines 201, 202)
    *   struct hb_struInteger (line 207)
    *   struct hb_struLong (line 219)
  * source/vm/hvm.c
    * switch hb_vmDo( USHORT uiParams ) to hb_vmDo( UINT uiParams )
    * Fix several warnings (-Wall)

  /* Please recompile all */


2007-05-02 20:51 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * include/hbclass.ch
    ! Fixed "Super" translate
    * CLASS <classname> FROM <FromFunc>( <FromClass> )
      /*
         If you declare a class with the clause FUNCTION,

         Example:

             CLASS MyClass FUNCTION MyNewClass
                ...

         if this must be inherit from other class you need to do

             CLASS MyClass2 FROM MyNewClass( MyClass )
                   ^ClassName    ^Function   ^From ClassName

	 **Only in these cases**
      */

2007-05-02 22:00 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * makefile.pc
    ! fix to avoid warnings and errors at hvm.c compiling.

2007-05-02 18:58 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/itemapi.c
    + Add hb_itemPutDate()
    * Minor optimizations
    * Fix warnings reported by Enrico Maria Giordano
    * Thanks Enrico Maria Giordano

2007-05-02 09:07 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * include/hbclass.ch
    ! Fixed Broken INHERIT FROM Scalar Classes

2007-05-02 10:35 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/makefile.vc
    - Its revert all changes below:
    * Add option -Ox
    * Removed options -Og -Op -GB, declared deprecated by msvc 8
    * Removed option -Ow, ignored by msvc 8
    * Changed option -o to -Fe, new option for output executable file
    * Thanks Paul Tucker
    * Thanks Alex Strickland

2007-05-02 10:28 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/fastitem.c
    * Fix warning reported by Enrico Maria Giordano
  * source/vm/hvm.c
    * Fix warnings reported by Enrico Maria Giordano
    * Fix incorrect code reported by Walter Negro (line 8107)
    * Thanks Enrico Maria Giordano
    * Thanks Walter Negro

2007-05-2 10:40 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * source/rdd/dbfcdx/dbfcdx.c
  * source/rdd/bmdbfcdx/bmdbfcdx.c
    - removed unused code
    * undo changed in for clause for customer index. to be cl53 compatible

2007-05-02 03:00 UTC-0300 Walter Negro <anegro/at/overnet.com.ar>
  * source/rtl/hbserial.prg
  * source/rtl/hbsrlraw.c
  * source/vm/hvm.c
    * support for serialize ande deserialize of array, hash with
      multireference or autoreference
    ! Fix typo error in hb_xvmHashGen()
  * source/rtl/win32ole.prg
    * support for datetime in VT_DATE values.

2007-05-01 20:40 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/browse.prg
    * replaced @..SAY to DispOut() functions to speed up browse initialization.
    ! fixed to add picture "@Sn" if char field width is larger than column.
    ! fixed browse performance under index operation.
    ! fixed memo edit window minimum coordinates.
    ! fixed to call rlock()/dbUnlock() if database is in shared mode.

2007-05-01 11:17 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/hvm.c
    * Fix warnings and errors reported by bcc 5.8.2
    * Fix error reported by Mindaugas (loops at lines 509,515)
    * Thanks Toninho
    * Thanks Mindaugas

2007-04-30 21:45 UTC-0300 Antonio Carlos Pantaglione <toninho@fwi.com.br>
   * config/w32/bcc32.cf
     * Changed CFLAGS definition to be compliant with makefile.bc

2007-04-30 19:50 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/fastitem.c
    * Minor optimizations

2007-04-30 17:41 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/makefile.vc
    + Add option -Ox
    - Removed options -Og -Op -GB, declared deprecated by msvc 8
    - Removed option -Ow, ignored by msvc 8
    * Changed option -o to -Fe, new option for output executable file

2007-04-30 17:12 UTC-0300 Ranier Vilela <ranier/at/cultura.com.br>
  * source/vm/hvm.c
    + Add hb_vmDoInitFunc()
    * Changed hb_vmDoInitClip() to hb_vmDoInitFunc( "CLIPINIT" )
    * Changed hb_vmDoInitOle() to hb_vmDoInitFunc( "HB_OLEINIT" )
    * Changed hb_vmDoInitHashEntry() to hb_vmDoInitFunc( "HASHENTRY" )
    + Add hb_vmDoModuleFunctions()
    * Changed hb_vmDoModuleInitFunctions() to hb_vmDoModuleFunctions( s_InitFunctions )
    * Changed hb_vmDoModuleExitFunctions() to hb_vmDoModuleFunctions( s_ExitFunctions )
    * Many changes in code, touching small performance
    * Please, test and report errors.

2007-04-30 12:15 UTC+0200 Alex Strickland <sscc/at/mweb.co.za>
  * source/rtl/dllcall.c
  *  Add CALLDLL()
  *   Call a DLL function from (x)Harbour, the first parameter is a pointer returned from
  *   GetProcAddress above. Note that it is hardcoded to use PASCAL calling convention.

2007-04-29 21:15 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbpcode.h
  * include/hbvm.h
  * include/hbvmpub.h
  * include/hbxvm.h
  * source/compiler/genc.c
  * source/compiler/gencc.c
  * source/compiler/harbour.sly
  * source/compiler/hbdead.c
  * source/compiler/hbfix.c
  * source/compiler/hblbl.c
  * source/compiler/hbpcode.c
  * source/compiler/hbpcstat.c
  * source/compiler/hbstripl.c
  * source/vm/hvm.c
  * include/hbexprb.c
  * include/hbexprc.c
  * source/compiler/exproptb.c
  * source/compiler/exproptc.c
    * Standardized and improved HB_P_[SET]LOCANEAR* support
    + Added HB_P_[PUSH]LOCALNEARINC and HB_P_[PUSH]LOCALNEARDEC to poptimize <local> += 1 and <local> -= 1

  * source/vm/maindllp.c
    * Updated hb_vmProcessSymbols() as per recent change

2007-04-29 12:06 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * include/hbclass.ch
    * Several Changues
      - Removed __CLS_PARAM, __CLS_PAR00, __HB_CLS_PAR
      - Removed .. Not loger nedded
	#xcommand _HB_MEMBER <MethodName>([<params,...>])() [<*x*>] => _HB_MEMBER <MethodName>(<params>) <x>
	#xtranslate @<!funcname!>([<params,...>])() => @<funcname>(<params>)
      + Add _InheritFrom_, _AsFunc_, _AsName_, _AsStr_, _AsStrLst_, __OPT__
      * Now Works with Delegate Message
	MESSAGE ... IS
	MESSAGE ... IS ... TO ...
	MESSAGE ... IS ... IN ...
	MESSAGE ... TO ...
	MESSAGE ... IN ...
	VAR ... IS ...
	VAR ... IS ... TO ...
	VAR ... IS ... IN ...
	VAR ... TO ...
	VAR ... IN ...

  * include/classes.h
    + Add to METHOD
   	PHB_SYMB pMsgIs;
	PHB_SYMB pMsgTo;

  * source/vm/classes.c
    * Change hb___msgDelegate
      + Now work full delegate at Run Time

  * source/rtl/tclass.prg
    - Remove Code
       /* Remove possible ( <x,...> )*/
      IF ( nAt := At( "(", cMethod ) ) > 0
        cMethod := RTrim( Left( cMethod, nAt - 1 ) )
      ENDIF
    * Now Resolved with preprocesor

  * utils/xbscript/xbs_harb.ch
    * changue FROM CHARACTER to FROM _CHARACTER

  /* Please make a clean copy */

2007-04-27 18:45 UTC-0500 Vicente Guerra <vicente@guerra.com.mx>
  * include/hbinit.h
    ! Fixed pModulesymbols typos.

2007-04-27 11:24 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * source/rdd/dbcmd.c
    ! use default RDD instead of current one in COPY TO and APPEND FROM

2007-04-26 11:01 UTC-0300 Antonio Carlos Pantaglione <toninho@fwi.com.br>
   * source/rtl/inkey.c
     ! Changed call to hb_itemGetC() by hb_itemGetCPtr()
     - Removed hb_itemFreeC()

2007-04-25 10:02 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
   * source/vm/classesc.c
      + Add redundant hb_objGetClass()

2007-04-25 11:13 UTC-0300 Antonio Carlos Pantaglione <toninho@fwi.com.br>
   * source/rtl/inkey.c
     ! Fixed a memory leak.

2007-04-24 21:35 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/classes.h
    * Modified pDestructor member of CLASS to PMETHOD
  * source/vm/classes.c
    * Resolved thread safety problem of ->pDestructor using a static symbol

  * include/hbinit.h
  * include/hbvmpub.h
  * source/compiler/genc.c
  * source/vm/dynsym.c
  * source/vm/hvm.c
  * source/vm/runner.c
    * Simplified/optimized recent modification by avoiding ppModuleSymbols union member, in favor of having a [fake] ->pDynSym
      (1 per compiled modulle) also for static symbols.

  * contrib/libnf/fttext.c
  * contrib/rdd_ads/ads1.c
  * source/pp/pplib3.c
  * source/rdd/dbf1.c
  * source/rdd/delim1.c
  * source/rdd/sdf1.c
  * source/rdd/bmdbfcdx/bmdbfcdx1.c
  * source/rdd/dbfcdx/dbfcdx1.c
  * source/rdd/dbfdbt/dbfdbt1.c
  * source/rdd/dbffpt/dbffpt1.c
  * source/rdd/dbfntx/dbfntx1.c
  * source/rtl/version.c
  * source/vm/cmdarg.c
    - Reverted recent compliance change which is no longer needed

  * source/vm/codebloc.c
    - Removed old commented code

  * include/hbsetup.h
    * Changed HB_PCODE_VER to 9
      (Altough we never released previous change, as I'd like to avoid bogus GPF reports

  * source/rtl/cstr.prg
    + Added optional 4th argument <lBin> to ValToPrgExp() [default is .F.] to request binary representation for strings
  * source/rtl/persist.prg
    * Use ValToPrgExp() with lBin set to .T. for Codeblocks.

2007-04-24 20:10 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/browse.prg
    * minor position adjust after press K_UP, K_PGUP or K_CTRL_PGUP to go
      back from new row to last row.

2007-04-24 08:55 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/browse.prg
    ! fixed append mode when K_DOWN or K_PGDN key is pressed after last row.
    ! fixed K_CTRL_PGDN to doesn't set append mode.
    + added xHarbour extensions:
      * open edit window for memo field. Also, save memo content with K_ALT_W
        key, if HB_EXT_INKEY is defined.
      * automatic edit field, by pressing K_ENTER of the first column of the
        next row after the last column is edited in the current row.

  * source/rtl/tbrowse.prg
    ! fixed IsDb() static function to syncronize row position when tbrowse is
      initialized over a database in bottom record.

2007-04-22 18:45 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbclass.ch
  * include/classes.h
  * include/hbapi.h
  * include/hbinit.h
  * include/hbsetup.h
  * include/hbvm.h
  * include/hbvmpub.h
  * include/hbxvm.h
  * source/compiler/genc.c
  * source/compiler/gencc.c
  * source/vm/classes.c
  * source/vm/codebloc.c
  * source/vm/dynsym.c
  * source/vm/errorapi.c
  * source/vm/hvm.c
  * source/vm/macro.c
  * source/vm/maindllp.c
  * source/vm/proc.c
  * source/vm/runner.c
  * Global change profile:
    ! Optimized prg function call speed by avoiding pGlobals argument to hb_vmExecute()
    ! Optimized memory usage by:
      - Above reduces 4 bytes * deepest stack nesting
      - Removed member pModuleSymbols fro  * METHOD structure (every DATA * 2 + every METHOD definition of every class defnition * 4 bytes)
      - Removed pSymbols and pGlobals fro  * HB_CODEBLOCK (every codeblock definition + every inline method * 8 bytes)
                /* also renamed procname to symbol */
    * Changed HB_PCODE_VER to 8
    * Converted pDynSy  * of HB_SYMB to a NAMELESS union of pDynSy  * and ppModuleSymbols
      /*
         Tested nameless union compilation under MSVC, BCC, and xCC (POCC)
         please advise of compilation problem, if so we'll need to name the union,
         which wiill force sadditional syntax changes in few source files.
       */
    * Renamed pModuleSymbols memeber of SYMBOLS to pSymbolTable to avoid confusion
    + Added memeber pGlobals ro SYMBOLS (4 bytes * prg compiled module)
    * hb_vmProcessSymbols() now returns the Symbole Table Container (PSYMBOLS)
    * hb_[x]vmPushBlock[short] takes 2 less arguments pSymbols and pGlobals
    * hb_[x]vmPushMacroBlock takes 1 less argument pSymbols
    * hb_codeblockNew() takes 1 less argument pGlobals
    * hb_vmExecute() takes 1 less argument pGlobals
    * Default scope of new Dynamic Symbol to HB_FS_PUBLIC
    * Corrected Symbol Table of loaded HRB files to have HB_FS_LOCAL scope for locallly defined functions
    * Corrected loaded hrb files to have correct module name
    * HB_P_PUSH|POPGLOBAL[REF] now has minor overhead to resolve pGlobals fro  * cuurent pModuleSymbols container
    * Class creation and data/methods definition has minor overhead to resolve pModuleSymbols and store symbol which made the definition.
      /*
         Stack trace should now be completley accurate, showing correct source code location
         of any Method/Inline even for complex inheritance
       */
    * hb_vmSend() has minor overhead to force correct module context for object methods.
    * hb_vmPushSymbol() removed minor overhead of setting codeblock module context
    * hb_vmDoBlock() has minor overhead to force correct module context of codeblock instead of more frequently executed hb_pushSymbol().
    * hb_vmRegisterSymbols() will now detect and warn registed public function which was eliminated by linker due to same symbol in prior module
    * Extended HB_SaveBlock()/HB_RestoreBlock() functionality to support save/restore in different compilation modulles.
    + Added hb_objGetClassSymbol( PHB_ITE  * pObject )
    + hb_vmFindSymInModule()
    - Removed redundant hb_objGetClass() - see hb_objClassH()

  * contrib/libnf/fttext.c
  * contrib/rdd_ads/ads1.c
  * source/rdd/dbf1.c
  * source/rdd/delim1.c
  * source/rdd/sdf1.c
  * source/rdd/bmdbfcdx/bmdbfcdx1.c
  * source/rdd/dbfcdx/dbfcdx1.c
  * source/rdd/dbfdbt/dbfdbt1.c
  * source/rdd/dbffpt/dbffpt1.c
  * source/rdd/dbfntx/dbfntx1.c
  * source/pp/pplib3.c
  * source/rtl/version.c
  * source/vm/cmdarg.c
  * source/vm/initsymb.c
    * Updated to compile after above changes

  * source/rtl/trace.c
    + Added static s_bEmpty to allow TraceLog() to be retain output sent before hb_vmInit()

  * source/rtl/tclass.prg
    + Added argument nBase as 1 to __ClsNew()

  * source/rtl/tobject.prg
    * Minor optimizations

  * tests/savebloc.prg
  + tests/restbloc.prg
    * Updated to sample persistance of Codeblocks across different compilation modules

  /* Sorry, if I may have missed some changes. */

2007-04-20 11:24 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * include/hbapicdp.h
  * include/hbapilng.h
  * source/rdd/dbcmd.c
  * source/rdd/dbnubs.c
  * source/rdd/hsx/cftsfunc.c
  * source/rtl/accept.c
  * source/rtl/defpath.c
  * source/rtl/oemansi.c
  * source/rtl/pad.c
  * source/rtl/shadow.c
  * source/rtl/trim.c
  * source/vm/debug.c
    * changed HB_FUNCNAME( <name> )() to HB_FUNC_EXEC( <name> )

2007-04-19 23:39 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/compiler/exproptc.c
  * source/macro/macroc.c
  * include/hbexprc.c
    ! Fixed silly but nasty typos in last commit to HB_P_SENDWITH[SHORT] which broke few compunded operations like :n++ ++:n

2007-04-19 16:50 UTC-0300 Antonio Carlos Pantaglione <toninho@fwi.com.br>
   * source/common/hbver.c
     + Added Windows Vista version.

2007-04-19 10:10 UTC-0300 Walter Negro <anegro/at/overnet.com.ar>
  * source/common/hbdate.c
  * source/compiler/gencc.c
  * source/rtl/dateshb.c
  * source/vm/arrays.c
    * Correct compiler warnings reported by Maurilio Longo
  * source/vm/hvm.c
    ! Fix bug in hb_vmSubDate() for operation as Date() - 1.0

2007-04-18 08:50 UTC-0300 Antonio Carlos Pantaglione <toninho@fwi.com.br>
  * source/rdd/dbcmd.c
    ! Update NetErr() in ordListAdd(). Synched with Harbour.

2007-04-17 16:44 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbexprb.c
  * include/hbexprc.c
    * Revised compilation of HB_P_SENDWITH[SHORT] to use HB_P_PUSHWITH
  * include/hbstack.h
  * include/thread.h
  * source/vm/thread.c
  * source/vm/hvm.c
    - Removed bWithObject memeber of HB_STACK
  * source/vm/hvm.c
    * Removed all bWithObject code

  /* WARNING: All prg files MUST be recompiled!!! */

2007-04-17 10:53 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * source/rdd/bmdbfcdx/bmdbfcdx1.c
    * fixed bug on SET FILTER TO <expr> after REPLACE
      Unrecoverable error 9105: hb_cdxIndexLockWrite: writeLock after readLock.
      It occurs only with SET OPTIMIZE ON.

2007-04-16 22:20 UTC-0300 Antonio Carlos Pantaglione <toninho@fwi.com.br>
  * include/hbapi.h
  * source/rtl/valtype.c
    + support for HB_ISDATETIME() function

  * include/hbstruct.h
  * source/rtl/tobject.prg
    + improved STRUCTURE/MEMBER/ENDSTRUCTURE to support DATETIME and HASHES

  * tests/struct.prg
    ! updated with datetime and hash sample

2007-04-16 22:57 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/simplex.c
    * Compiler warning

2007-04-16 21:15 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * makefile.pc
  * hrbdll.pc
    + added clpclass, tscalar and classesc.c into rsp script file.

2007-04-16 13:02 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/simplex.c
  * source/pp/ppcore.c
    * Compiler warnings

2007-04-16 12:25 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/browse.prg
    ! fixed to go bottom record as reported in comp.lang.xharbour news.

  * hrbdll.bc
    + added tscalar.prg

2007-04-15 23:42 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbpp.h
  * source/compiler/ppcomp.c
  * source/pp/ppcore.c
    + Added support for #pragma push ... and #pragma pop ...
      /* This allows save, modify, and later restore of any compiler switch */

  * include/wintypes.ch
    + Added #pragma push -w0, #pragma pop -w around overloaded #define int and INT to supress overloaded warnings

2007-04-15 17:55 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/rtl/cstr.prg
    * Object representation of ValToPrg() to be compilable

2007-04-15 15:09 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * makefile.bc
    * fixed missing file clpclass.prg

2007-04-15 16:11 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * hrbdll.bc
  * hrbdll.gc
  * hrbdll.pc
  * hrbdll.vc
  * hrbdll.wc
     * Added clpclass.prg and tscalar.prg

2007-04-15 15:58 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/rtl/tobject.prg
  * source/rtl/tscalar.prg
    * Corrected static HB_FUNC( ... ) to HB_FUNC_STATIC( ... )

2007-04-15 12:36 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * source/rtl/tclass.prg
     * minor change for future implementation
     * move __CLASSNEW, __CLASSADD, __CLASSINS to clpclass.prg
        * this file only be linked if it's necesary
     * move Scalar Classes to tscalar.prg
        * this file only be linked if it's necesary
   + source/rtl/clpclass.prg
   + source/rtl/tscalar.prg
     + Add POINTER:FUNCNAME()
        * retrieves the function name of pointer
        ! be careful if pointer not point to a function maybe generating a GPF
   * source/rtl/tobject.prg
     * now :MSGNOTFOUND() works Like Class(y))
   * source/rtl/makefile
   * makefile.bc
   * makefile.vc
   * makefile.pc
   * makefile.wc
     * add clpclass.prg, tscalar.prg

2007-04-15 14:45 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbclass.ch
    * Modified to use new UTILITY attribute (Class code is never a startup code)
  * source/rtl/cstr.prg
    + Added support for cyclic arrays
    * Simplified cyclic detection
    * Improved format of ValToPrg() arrays and objects representation

2007-04-14 23:46 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * source/rtl/tclass.prg
  * source/vm/classes.c
    /*
      I reduced the size of the final object, when this it is inherited
      At VM level OOPS Engine only use the first element of the object to
      store a reference to real self, Really we only need to have free the
      first element of Object.
    */

2007-04-14 17:45 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  + include/wintypes.ch
    + New header with common Windows types for use with C Structures and DllCalls.
  * include/cstruct.ch
    + Added CTYPE_VOID
  * include/hbdll.ch
    + Added support for new native syntax, which allow quick Cut & Paste from C headers.
    + Added #include "cstruct.ch" and "wintypes.ch"
  * include/hbvmpub.h
  * source/compiler/harbour.c
  * source/compiler/harbour.slx
  * source/compiler/harbour.sly
    + Added support for new UTILITY [STATIC] FUNCTION|PROCEDURE syntax.
      /* The UTILITY attribute indicates that such Func/Proc should NOT be used as STARTUP code even if
        it is the FIRST procedure in source. This means Utility Functions such as auto generated DLL wrappers
        no longer have to be placed at BOTTOM of source, which is counter intuitive. */
  * source/rtl/dllcall.c
    * Fixed silly typo (&& HB_IT_BYREF)
    * Fixed pushing pArg to not dereference (Paul is this correct?)
    + Added validation of DynaCall() by means of getLastError()
    * Preperation for additional work in progress
  * tests/dllcall.prg
    * Moved DLL declerations to TOP of file as it's now supported.
    + Added samples of native syntax.
  * source/vm/hvm.c
    * Missing type cast

2007-04-14 10:43 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * source/vm/hbvm.c
     * fixed bug in POINTER:EXEC with PROCNAME(), HB_QSELF()

2007-04-14 10:04 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * source/vm/hbvm.c
     * fixed BLOCK:EVAL()
     + Added BLOCK:EXEC()
     + Added POINTER:EXEC()
  + test/test_exec.prg
     * New sample to demostrate the use of :EXEC()

2007-04-14 03:03 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  + include/hbdll.ch
    + New header file with DllCall constants and FoxPro and FWH compatible DLL Syntax support
  * source/rtl/dllcall.c
    * Moved constants shared with PRG code to hbdll.ch
    + Added support for Long/Int/Bool by ref
    + Added validation and error reporting to DLLPREPARECALL()
    + Added save/restore of ESP in MSVC branch of DynaCall() to avoid GPF
      /* Paul and assembler experts, please review - also I suspect Borland and MingW should also save/restore ESP */
  + tests/dllcall.prg
    * New sample to demonstrate WIN DLL support using FoxPro and FWH style declerations

2007-04-13 18:08 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/vm/arrays.c
    + Added argument validation and error reporting for hb_arrayfromParams()
  * source/vm/arrayshb.c
    + Added suppport for <nLevel> to HB_APARAMS() - default is 0
    + Added argument validation and error reporting for HB_APARAMS()

2007-04-13 16:17 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/vm/hvm.c
    * Reverted silly factorization of HB_QSELF()
  * source/rtl/win32ole.prg
    * Do NOT inherit from HB_Object() to avoid OLE namespace pollution

2007-04-13 11:38 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbpp.h
    + Added:
       #define HB_PP_CMP_KEY        0x1000
       #define HB_PP_CMP_MATCHRULE  0x2000
  * source/pp/ppcore.c
    * Corrected #[x]untranslate/[x]uncommand to work as documented
  * include/hbclass.ch
    * Corrected usage of #[x]untranslate

2007-04-12 10:10 UTC-0300 Luiz Rafael Culik Guimaraes
  * makefile.bc
    makefile.vc
    makefile.pc
    makefile.wc
    !added missing classesc.c

2007-04-12 08:31 UTC-0300 Luiz Rafael Culik Guimaraes
  * debian/README.debian
  * debian/changelog
  * debian/control
  * debian/copyright
  * debian/dirs
  * debian/files
  * debian/harb.sh
  * debian/rules
  * debian/substvars
  * make_deb.sh
    ! updated  now it generate an usable .deb

2007-04-11 21:11 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * source/vm/classes.c
    - Moved Functions __CLS_PARAM, __CLS_PAR00 to classesc.c
  + source/vm/classesc.c
    * This File is Only For Keep functions nedded for old versions
      of the compiler, and this not will be linked in a exe file,
      only if it's necesary.
    + Keep Functions __CLS_PARAM, __CLS_PAR00
  * source/vm/makefile
    * Add classesc.c

2007-04-11 18:39 UTC-0700 Andres Reyes <andresreyes_mzt/at/yahoo.com.mx>
  * include/hbextern.ch
    * Comment EXTERN __CLS_PARAM
  * include/hbclass.ch
    * Optimization for speed
    + Added #xtranslate __CLS_PARAM
    + Added #xtranslata __CLS_PAR00
  * source/vm/classes.c
    * Not Needed
    * Comment __CLS_PARAM
    * Comment __CLS_PAR00
  * source rtl/tobject.prg
    * More Class(y) compatibility
    + Adding messages :Exec(), :Eval(), :basicSize(), :Copy(), :DeepCopy()
    * :New() Calls :Init() no limited params

2007-04-11 21:26 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/pp/ppcore.c
    * Minor correction to spaces attribute of seperated tokens of recent commit

2007-04-11 15:22 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/pp/ppcore.c
    + Added logic to break '<<' into 2 tokens ('<' '<') when prefixed by ESCAPE '\' in #directives.

2007-04-11 03:55 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/vm/extend.c
  * source/vm/hvm.c
    * Cleaned unused vars

2007-04-11 02:15 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbstack.h
    * Removed redundant member lBaseItem from HB _STACK_STATE
    + Added hb_stackgetBase()
  * include/hbvmpub.h
    + Added member paramsoffset to hb_struSymbol
  * source/vm/arrays.c
    * Use ->item.asSymbol.paramsoffset when building param arrays
  * source/vm/arrayshb.c
    * Sumplified HB_APARAMS to use new hb_stackGetBase()
  * source/vm/estack.c
    * Adjusted for changes in hb_struSymbol and HB_STACK_STATE
    + Added hb_stackgetBase()
    * Simplified hb_stackDispCall()
  * source/vm/hvm.c
    * Replaced few non recoverable hb_errRT_BASE() with hb_errInternal()
    * Adjusted hb_vmFrame() to use new ->item.asSymbol.paramsoffset
    * Simplified HB_QSELF() and HB_RESTOREBLOCK() to use new hb_stackGetBase()
  * source/vm/proc.c
    * simplified to use hb_stackGetBase()
  * source/vm/pvalue.c
    * Adjusted to use ->item.asSymbol.paramsoffset

  * source/vm/garbage.c
    * Corrected declaration to top of block

  * source/vm/errorapi.c
    * Minor format

2007-04-10 14:20 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbapi.h
    + Added Harbour compatible hb_gcFunc() and hb_parptrGC()
  * include/hbapiitm.h
  * source/vm/itemapi.c
    + Added Harbour compatible hb_itemGetPtrGC()
  * source/vm/garbage.c
    + Added Harbour compatible hb_gcFunc()
    * Minor simplifications
  * source/pp/ppgen.c
  * source/pp/pplib.c
  * source/pp/pplib2.c
    * Synched with Harbour

  * source/vm/hvm.c
    ! Fixed GPF trap in hb_vmPushDynSym()

  * include/hbapi.h
  * include/hbstack.h
  * source/vm/arrays.c
  * source/vm/debug.c
  * source/vm/extend.c
  * source/vm/fastitem.c
  * source/vm/hvm.c
  * source/vm/pcount.c
  * source/vm/pvalue.c
    * Simplified/optimized handling of variable parametes (...)
     /* All xHarbour apps should be faster now because the optimized macros/functions were very frequently used */

2007-04-10 10:06 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * source/rdd/bmdbfcdx/bmdbfcdx1.c
    * fixed bug on BM_DbSeekWild( ... )
      when all the keys were asked for, first never it was included.

2007-04-09 18:47 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/pp/ppcore.c
    * Uncommented HB_PP_NO_LINEINFO_TOKEN

2007-04-09 14:48 UTC-0800 Tony Bretado <tony@bretado.com>
  * source/rtl/tbrowse.prg
    Adjust behavior of ::lHitBottom & ::lHitTop, based on Eduardo Fernandes observations.

2007-04-09 17:05 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/compiler/ppcomp.c
    ! Fixed loading of system defines to precede processing of user defined rules
    * Readded support of hb_pp_STD_CH_ADDITIVE
  * source/pp/ppcore.c
    * Synched with some Harbour modifications
    * Improved HB_PP_ERR_UNKNOWN_RESULT_MARKER and HB_PP_ERR_WRONG_LABEL to provide more details

2007-04-08 03:18 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/rtl/gtapi.c
    * Temporrarily commented calls to hb_gt_SetAttributeCT()

  * include/common.ch
    * Minor simplifications and corrections

  * source/vm/hash.c
    * Minor format

  * source/compiler/harbour.sly
    * Minor typo

  * include/hbpp.h
    * Removed HB_PP_TOKEN_SEND from HB_PP_TOKEN_NEEDLEFT() to allow unconditional support for send as starting exp

  * include/hbapi.h
    + Added #define HB_VAR_PARAM_FLAG 255

  * source/compiler/harbour.c
  * source/vm/arrays.c
  * source/vm/debug.c
  * source/vm/estack.c
  * source/vm/extend.c
  * source/vm/fastitem.c
  * source/vm/pcount.c
  * source/vm/pvalue.c
  * source/vm/hvm.c
    * Revised variable arguments support to use HB_COMP_ERR_TOOMANY_ARGS instead of hardcoded 255

  * include/hberrors.h
  * source/compiler/hbgenerr.c
    + Added #define HB_COMP_ERR_TOOMANY_ARGS -> "Too many arguments to function: \'%s\'"

  * include/hbexpra.c
    + Added error generation if argument count greater than HB_VAR_PARAM_FLAG
    + Added support for Array(...) as valid static initializer
    + Added support for Hash(...) as valid static initializer

  * include/hbpcode.h
  * include/hbxvm.h
  * source/compiler/genc.c
  * source/compiler/gencc.c
  * source/compiler/hbdead.c
  * source/compiler/hbfix.c
  * source/compiler/hblbl.c
  * source/compiler/hbpcode.c
  * source/compiler/hbpcstat.c
  * source/compiler/hbstripl.c
  * source/vm/hvm.c
  * source/compiler/exproptb.c
  * include/hbexprb.c
    + Added suport for creating Hashes using PCODE

2007-04-06 19:15 UTC-0800 Tony Bretado <tony@bretado.com>
  * source/rtl/gtapi.c
    + New function hb_gtSaveAll(). Needed to Save WHOLE Screen from inside a CT Window.
    ! Fix hb_ctShadow(). In order to draw shadow attribute CA-Tools compatible.
      Now it calls hb_gt_SetAttributeCT() defined in gtwvt.c
         /* Please check other gt libraries! */
  + source/rtl/gtwvt/gtwvt.c
    + New function hb_gt_SetAttributeCT(). Needed to draw shadow attribs CA-Tools compatible.

2007-04-06 17:53 UTC-0800 Tony Bretado <tony@bretado.com>
  * source/rtl/tbrowse.prg
    fixed bugs in ::lHitBottom.

2007-04-05 04:15 UTC-0300 Walter Negro <anegro/at/overnet.com.ar>
  * include/hbapi.h
    New macro HB_IS_OBJECTDESTROYED()

  * include/hbvmpub.h
    Modification HB_BASEARRAY structure, adding uiDestroyed member.

  ! source/vm/arrays.c
    Resolve several problems related with destructor of objects.
    ! Double execution of destructor recursive (hb_arrayReleaseGarbage() and hb_arrayReleaseBase())
    ! Double execution of destructor non-recursive, in the same execution of GC.
    ! Execution methods of object destroyed in destructor.
    % Minor optimization

  ! source/vm/arrayshb.c
    HB_ATOKENS() clean Return area incorrectly.

  ! source/vm/classes.c
    ! Avoid execution methods of object destroyed simulating virtual method.
    ! Set bSymbol to FALSE when use pointer to function.
    % Minor optimization

  ! source/vm/hvm.c
    % Optimization of With Object accessing to Datas.
    ! Incorrect optimization in hb_vmEqual() and hb_vmNotEqual() with HB_IT_POINTER. Some pointers are COMPLEX values.
    ! Save HB_VM_STACK.bWithObject state before clear Return in hb_vmSend(), to avoid to use the object of With Object in destructor of other object.

2007-04-02 17:54 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * source/rdd/dbf1.c
    + added default value to TimeStamp fields, automatically.

2007-04-02 17:54 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * include/hbapi.h
  * source/rdd/bmdbfcdx/bmdbfcdx1.c
  * source/rdd/dbf1.c
  * source/rdd/dbfcdx/dbfcdx1.c
  * source/rdd/workarea.c
    + added support for field types TimeStamp and DateTime compatible with
      Visual FoxPro. Can be created the fields with DbCreate using the next
      fieldTypes:
	DateTime	T
	TimeStamp	@

2007-03-31 13:40 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/tget.prg
    ! fixed "@B" picture behaviour as reported from xharbour-dev's list.

2007-03-30 14:10 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * include/hbpp.h
    * fixed typo in comment
  * source/rdd/bmdbfcdx/bmdbfcdx1.c
  * source/rdd/dbfcdx/dbfcdx1.c
  * source/rdd/dbfntx/dbfntx1.c
    + added some missing DBOI_* actions
  * source/rdd/dbstrux.prg

2007-03-30 09:26 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * source/rdd/dbfcdx/dbfcdx.c
    + added support for DBORDERINFO( DBOI_ISMULTITAG )
    * modified to admit DBOI_KEYDELETE and DBOI_KEYADD ignoring the FOR clause,
      that does not have meaning in customer index in order to add or del KEYS.

2007-03-29 10:53 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * source/rdd/bmdbfcdx/bmdbfcdx.c
    + added support for DBORDERINFO( DBOI_ISMULTITAG )

2007-03-28 21:00 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/minmax.c
    ! fixed lines 70 and 146. Changed "p1->item.asDate.value" to
      "p2->item.asDate.value" as reported by Serge Jakimoff from
       comp.lang.xharbour news.

2007-03-28 16:00 UTC+0200 Alex Strickland <sscc/at/mweb.co.za>
  * source/rtl/seconds.c
    * Use GetLocalTime() when HB_OS_WIN_32 defined.

2007-03-27 22:42 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * contrib/rdd_ads/ads1.c
    * Change direct access of hb_set to use hb_GetSetStructPtr()
    * Corrected few HB_TR_ALWAYS to HB_TR_DEBUG

 /* Commited on behalf of Brian Hays */

2007-03-27 10:22 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * include/hbset.h
  * source/rtl/set.c
    + Added missing HB_EXPORTs

  * source/compiler/harbour.slx
  * source/macro/macro.slx
    * Simplified processing of new AM and PM tokens.

  * tests/dates5.prg
    * Minor formating

2007-03-27 03:29 UTC-0300 Walter Negro <anegro/at/overnet.com.ar>
   * source/common/hbdate.c
    ! Correct some Warnings
  * source/compiler/harbour.slx
     ! Correct compilation of AM and PM as Identifier

2007-03-26 18:40 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/ct/ctnet.c
    * fixed NetPrinter() to treat "PRN" as "LPT1".

2007-03-26 11:24 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/common/hbdate.c
  * source/vm/hvm.c
    * Type cast for div() arguments needed by MSVC

2007-03-25 21:20 UTC-0300 Walter Negro <anegro/at/overnet.com.ar>
  * source/common/hbdate.c
  * source/vm/hvm.c
  * source/vm/itemapi.c
    ! Correct some Warnings

2007-03-25 03:00 UTC-0300 Walter Negro <anegro/at/overnet.com.ar>
  * include/hbapi.h
  * include/hbapiitm.h
  * include/hbcomp.h
  * include/hbdate.h
  * include/hbexpra.c
  * include/hbexprb.c
  * include/hbexprop.h
  * include/hbmacro.h
  * include/hbpcode.h
  * include/hbset.h
  * include/hbstack.h
  * include/hbvm.h
  * include/hbvmpub.h
  * include/hbxvm.h
  * include/set.ch
  * include/std.ch
  * include/thread.h
  * source/common/expropt1.c
  * source/common/hbdate.c
  * source/compiler/genc.c
  * source/compiler/gencc.c
  * source/compiler/harbour.c
  * source/compiler/harbour.slx
  * source/compiler/harbour.sly
  * source/compiler/hbdead.c
  * source/compiler/hbfix.c
  * source/compiler/hblbl.c
  * source/compiler/hbpcode.c
  * source/compiler/hbpcstat.c
  * source/compiler/hbstripl.c
  * source/macro/macro.slx
  * source/macro/macro.y
  * source/rtl/dateshb.c
  * source/rtl/descend.c
  * source/rtl/empty.c
  * source/rtl/hbsrlraw.c
  * source/rtl/minmax.c
  * source/rtl/samples.c
  * source/rtl/set.c
  * source/rtl/Makefile
  * source/vm/arrays.c
  * source/vm/arrayshb.c
  * source/vm/asort.c
  * source/vm/estack.c
  * source/vm/extend.c
  * source/vm/hash.c
  * source/vm/hvm.c
  * source/vm/itemapi.c
  * source/vm/macro.c
  * source/vm/memvars.c
  * utils/hbmake/hbmutils.prg
  * makefile.bc
  * makefile.dc
  * makefile.gc
  * makefile.pc
  * makefile.vc
  * makefile.wc
  * hrbdll.bc
  * hrbdll.dc
  * hrbdll.gc
  * hrbdll.pc
  * hrbdll.vc
  * hrbdll.wc
  + tests/dates5.prg
  - source/rtl/dates.c

    Added support for datetime values.

2007-03-24 19:40 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
  * source/pp/ppcore.c
    * Corrected hb_pp_tokenCanStartExp() to return FALSE for inline seperator ';'
  * source/vm/classes.c
    * Minor cleanup
  * source/vm/cmdarg.c
    * Corrected possible GPF trap f.e. when VM is loaded as a stand alone DLL
