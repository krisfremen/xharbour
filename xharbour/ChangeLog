/*
 * $Id: ChangeLog,v 1.4295 2005/09/02 18:22:53 druzus Exp $
 */

/* Use this format for the entry headers:
   YYYY-MM-DD HH:MM UTC[-|+]hhmm Your Full Name <your_email@address>
   For example:
   2002-12-01 23:12 UTC+0100 Foo Bar <foo.bar@foobar.org>
*/

2005-09-02 11:55 UTC-0800 Ron Pinkas <Ron in xHarbour.com>
  * include/hbregex.h
    * xCC/lCC adjustment

2005-09-02 20:10 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * xharbour/bin/hb-func.sh
  * xharbour/xharbour.spec
  * xharbour/bin/pack_src.sh
  * xharbour/config/bsd/gcc.cf
  * xharbour/config/darwin/gcc.cf
  * xharbour/config/dos/djgpp.cf
  * xharbour/config/dos/rsx32.cf
  * xharbour/config/dos/watcom.cf
  * xharbour/config/hpux/gcc.cf
  * xharbour/config/linux/gcc.cf
  * xharbour/config/linux/owatcom.cf
  * xharbour/config/os2/gcc.cf
  * xharbour/config/sunos/gcc.cf
  * xharbour/config/w32/gcc.cf
  * xharbour/config/w32/mingw32.cf
  * xharbour/config/w32/watcom.cf
    + added lib pcrepos

  * xharbour/contrib/rdd_ads/ads0.prg
  * xharbour/contrib/rdd_ads/ads1.c
  * xharbour/contrib/rdd_ads/adsfunc.c
  * xharbour/contrib/rdd_ads/rddads.h
    + register ADS as three separate RDDs: ADSNTX, ADSCDX, ADT
      (ADS RDD left for backward compatibility) -  they do not
      need to set table type.
    + synchronize SET_DECIMALS with ADS
    + added support for relations between ADS and non ADS workareas
      and ADS only relations which cannot be resolved by ADS
    ! fixed index key conversion in ordscope() and ordkeyval()
    + added support for ordRelKeyPos() (common RDD version of
      AdsGetRelKeyPos()/AdsSetRelKeyPos()) and tuned the value calculated
      for tables without indexes
    ! fixed BOF/EOF/FOUND flag updating in child areas
    * changed some internal logic basing on information about pending
      relations and simplified ADS BOF updating
    ! fixed SEEK LAST to work like in Clipper
      TODO: the found flag should be updated to respect pending movement
      forced by active filter on client side - it's still wrong.
    * changed SELF_LOCK()/SELF_RAWLOCK() to use ACE API directly (basing
      on documented behavior). It also resolve the problems with removing
      implicit locks which are not reported by AdsGetNumLocks() and were
      not unlocked.
    + added explicit locking inside APPEND() operation - it resolve the
      problem with automatic removing locks on appended records after
      any record movement or updating by ACE library but can introduce
      race condition - it should be consulted with ACE authors if it does.
    + added some missing checking for lock (when bTestRecLocks set) in some
      operation like DELETE()/RECALL()
    - removed SELF_SKIPRAW(), SELF_ADDFILED(), SELF_FIELDEXTENT(),
      SELF_CLEARSCOPE() methods
    + added SELF_SKIPFILTER(), SELF_GETREC() and SELF_PUTREC() methods
    + added methods for relations
    + added support for _SET_AUTOORDER
    + implement DBDROP(), DBEXISTS() with xHarbour file API - it should be
      enough for most of installation but we should also have alternate
      implementation with ACE API for remote file access when the resources
      are not mapped to client computer
    * read/write date values in Julian represenation if possible - this is
      our internal representation so we reduce unnecessary conversions for
      binary types and don't have to worry about _SET_DATEFORMAT setting
    ! SELF_GETVARLEN() now returns the real memo item length
    + added hb_rddGetADSWorkAreaPointer() to use instead of
      hb_rddGetCurrentWorkAreaPointer() in all ADS*() functions. The
      hb_rddGetADSWorkAreaPointer() returns NULL for non ADS* RDDs avoiding
      possible memory corruption in xHarbour or ACE area when bad handles
      or other AREA members were extracted/set
    + added some RDDI_* actions in SELF_RDDINFO()
    - removed unused members from ADS AREA
    * some other minor modifications not I do not remember now ;-)

  * xharbour/include/Makefile
  - xharbour/include/regex.h
  + xharbour/include/hbregex.h
    * renamed regex.h to hbregex.h
    + added prototypes for some basic xHarbour RegEx API

  * xharbour/include/dbinfo.ch
    + added DBOI_RELKEYPOS

  * xharbour/include/hbrdddbf.h
  * xharbour/source/rdd/dbf1.c
    + added SELF_PACKREC() for compatibility with Clipper and easier
      memopack implementation

  * xharbour/source/compiler/genc.c
    ! fixed generating symbol table when static function has the same name
      as memvar

  * xharbour/source/rdd/dbcmd.c
    + added ORDRELKEYPOS() - common for all RDDs functions which supports
      DBOI_RELKEYPOS which works like AdsGetRelKeyPos()/AdsSetRelKeyPos()
      in ADS RDD. ORDRELKEYPOS( [<nGoToPos>] ) -> <nCurrPos> | NIL
      is much less expensive then ordKeyNo()/ordKeyGoTo() combination
      and should be used to implement vertical scope instead of these
      functions.
        ordRelKeyPos() called without parameters returns current position
	in index (table) file in the range 0.0 to 1.0
	ordRelKeyPos( <nPos> ) sets new position in index (table) file.
	<nPos> should be in range 0.0 to 1.0

  * xharbour/source/rdd/workarea.c
    ! fixed typo in HB_TRACE message

  * xharbour/source/rdd/dbfcdx/dbfcdx1.c
    + added support for DBOI_RELKEYPOS - ORDRELKEYPOS() returns in DBFCDX
      exactly the same results as in ADSCDX when the same index file is
      used also when scopes are used. It's unintentional side effect of
      the simplest method I used for calculation.
    * modified to use xHarbour RegEx API not the POSIX one

  * xharbour/source/rdd/dbfntx/dbfntx1.c
    + added support for DBOI_RELKEYPOS - ORDRELKEYPOS() returns in DBFNTX
      differ results then in ADSNTX. In ADS AdsGetRelKeyPos() doesn't give
      valid results IMHO the same algorithm were used as for CDX format
      which doesn't respect keys in interior nodes which are significant
      in NTX format and the fact that the number of keys can be differ then
      number of subpages - the effect is that it reach 1.0 much faster then
      it should (we are not at EOF) and AdsSetRelKeyPos() cannot set position
      to records which are not at the lowest level but chose the nearest
      one.
    * modified to use xHarbour RegEx API not the POSIX one

  * xharbour/source/rtl/direct.c
  * xharbour/source/rtl/strmatch.c
  * xharbour/source/vm/memvars.c
    * modified to use xHarbour RegEx API not the POSIX one

  * xharbour/source/vm/hvm.c
    - removed unused label

  * xharbour/source/rtl/regex.c
    + added basic xHarbour RegEx functions
	BOOL hb_regexCompile( PHB_REGEX pRegEx, const char *szRegEx,
			     int iCFlags, int iEFlags );
	BOOL hb_regexGet( PHB_REGEX pRegEx, PHB_ITEM pRegExItm,
			  int iCFlags, int iEFlags );
	void hb_regexFree( PHB_REGEX pRegEx );
	BOOL hb_regexMatch( PHB_REGEX pRegEx, const char *szString,
			    BOOL fFull );
      This is very basic set of function which allow to eliminate all
      direct regex_t access in xHarbour core code. I will work on it
      in the future adding missing functionality and eliminating POISX
      meta layer.

  * xharbour/source/rtl/Makefile
  + xharbour/source/rtl/pcre/ChangeLog
    + added changelog file to mark any modification of original PCRE file
      for easier upgrading in the future

  * xharbour/source/rtl/pcre/chartables.c
  * xharbour/source/rtl/pcre/dftables.c
    ! added missing extern declaration to satisfy C++ compilers

  * xharbour/source/rtl/pcre/pcre_dfa_exec.c
    * commented unused variables

  * xharbour/source/rtl/pcre/pcreposix.c
    ! fixed offset setting for first match when REG_STARTEND is used

2005-09-02 13:40 UTC-0300 Luiz Rafael Culik<luiz at xharbour.com.br>
   * source/tip/ftpcln.prg
      It include 5 new methods
      Rename( cOld, cNew ) // to rename files on ftp server
      Ls( spec ) // to list ftp server contents
      UpLoadFile( cLocalFile, cRemoteFile )  // to upload files to server
      DownLoadFile( cLocalFile, cRemoteFile )  // to download files to server
      MKD( cPath )  // create an directory o ftp server
   + tests/tiptest/uploadftp.prg
      ! sample demostrating how to upload files to ftp server
   + tests/tiptest/dnldftp.prg

2005-09-02 11:45 UTC-0500 Paul Tucker <ptucker@sympatico.ca>
  * makefile.bc (corrected)
  * makefile.dc
  * makefile.gc
  * makefile.wc
  * hrbdll.gc
  * hrbdll.wc
    + source/rtl/pcre/*

2005-09-02 11:55 UTC+0200 Maurilio Longo <maurilio.longo@libero.it>
  * include/regex.h
    ! fixed path specification to be linux compatible
  * config/linux/gcc.cf
    * added -lpcrepos to compilation to use new regex engine

2005-09-02 00:15 UTC-0500 Paul Tucker <ptucker@sympatico.ca>
  * makefile.nt
  * makefile.vc
  * hrbdll.vc
  * hrbdll.bc
  * hrbdll.dc
  * hrbdll.pc
    + source/rtl/pcre/*

2005-09-01 11:37 UTC-0800 Ron Pinkas <Ron in xHarbour.com>
  * source/vm/hvm.c
    % Few optimizations related to hb_vmPushString() followed by hb_xfree()
    * [Hopefully] Completed support for operator overloading, including native types.

  /* NOTE: Operator Overloading
           --------------------

    1. When an operator has 2 arguments only the the LEFT side may overload the operation.

    2. NATIVE COMPATABILITY of operands PRECEDEs Operator Overloading declarations.
       This means that when the operation can be performed withOUT an error, overloading
       is NOT intended to take place, and will be ignored.
   */

2005-09-01 15:04 UTC+0200 Maurilio Longo <maurilio.longo@libero.it>
  * source/rtl/Makefile
    * forgot to commit its changes to use pcre/

2005-09-01 10:01 UTC+0200 Maurilio Longo <maurilio.longo@libero.it>
  * config/os2/gcc.cf
    * modified to add pcrepos.a library to linklist

2005-08-31 23:40 UTC-0300 Luiz Rafael Culik<culikr at uol.com.br>
  * source/tip/encoding/base64.c
  * source/tip/encoding/uuencode.c
  * source/tip/encb64.prg
    ! Fixed problem when doing base64 encoding on mt programs
      Reported by Rodrigo Moreno

2005-08-29 17:31 UTC-0800 Ron Pinkas <Ron in xHarbour.com>
  * include/hbexprb.c
  * source/compiler/exproptb.c
    - Removed optimization of INT + <x> into <x> <INT> HB_P_ADDINT, in hb_compExprUsePlus()
      because 1 + "A" is not same as "A" + 1

  * source/vm/hvm.c
    ! Fixed hb_vmPlus() to seperate handling of INT + <String(1)> from <String(1)> + <INT>

  * utils/hbtest/rt_hvma.prg
    * Corrected expected error to not modify arguments order for 1 + NIL

  * tests/associat.prg
    * Was not commited in my latest commit.


2005-08-31 17:10 UTC+0200 Maurilio Longo <maurilio.longo@libero.it>
   * makefile.bc
     * changed to work with new pcre 6.3 regex engine
   * bin\bld.bat
     * changed to add pcrepos.lib to built .exe files

   /* NOTE: This win32 build seems to work fine, I don't have other
            win32 compilers available, though.
   */

2005-08-31 13:30 UTC+0200 Maurilio Longo <maurilio.longo@libero.it>
  * source/rtl/regex.c
    * modified to use pcre/ contents
  * include/regex.h
    * modified to use pcre/ contents

  /* NOTE: After this change all builds, apart from the OS/2 GCC one, are _BROKEN_
           To make them work again build files needs to be updated to use
           pcre/ and build its content as a library ( pcrepos.lib )
  */

2005-08-31 13:25 UTC+0200 Maurilio Longo <maurilio.longo@libero.it>
  * source/rtl/pcre
    + added directory to contain pcre library
  * source/rtl/pcre/*
    + chartables.c
    + config.h
    + dftables.c
    + Makefile
    + pcre.h
    + pcreposix.c
    + pcreposix.h
    + pcre_compile.c
    + pcre_config.c
    + pcre_dfa_exec.c
    + pcre_exec.c
    + pcre_fullinfo.c
    + pcre_get.c
    + pcre_globals.c
    + pcre_info.c
    + pcre_internal.h
    + pcre_maketables.c
    + pcre_ord2utf8.c
    + pcre_printint.c
    + pcre_refcount.c
    + pcre_scanner.h
    + pcre_study.c
    + pcre_tables.c
    + pcre_try_flipped.c
    + pcre_ucp_findchar.c
    + pcre_valid_utf8.c
    + pcre_version.c
    + pcre_xclass.c
    + ucp.h
    + ucpinternal.h
    + ucptable.c
    + ucp_findchar.c
    + Added pcre 6.3 files which are needed by xharbour regex support

2005-08-31 08:05 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/tbrowse.prg
    ! fixed bug in down() and up() methods to skip records even if we
      call down/up before call stabilize, as Clipper's tbrowse.
      Bug reported by Gaby Zurbuchen.

2005-08-29 17:31 UTC-0800 Ron Pinkas <Ron in xHarbour.com>
  * source/vm/hvm.c
    + Added prg level HB_ResetWith( <xNewWith> )

2005-08-30 16:00 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/tbrowse.prg
    ! Minor fix in ColorRect() method.

2005-08-30 15:00 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/tbrowse.prg
    ! fixed ColorRect behaviour for Clipper compatibility.
    + created any new methods, datas and defines for ColorRect control and
      other ones are changed to same purpose.

2005-08-30 23:45 UTC+0700 Budyanto Dj. <budyanto@centrin.net.id>
  * contrib/gtwvw/gtwvw.c
  * contrib/gtwvw/hbgtwvw.h
    + supporting Maximize mode
    + new functions for centering window
    + bugfix and enhancement on scrollbar

  * contrib/gtwvw/doc/whatsnew.txt
    Details of above changes.

  + contrib/gtwvw/samples/maximize.prg
    Sample of using Maximize mode in a gtwvw app.

2005-08-30 13:30 UTC-0300 Luiz Rafael Culik<culikr at uol.com.br>
  * source/rtl/copyfile.c
    ! Fixed problem reported by Rafa Carmona. Now use hb_spOpen instes of hb_fOpen

2005-08-29 11:03 UTC-0800 Ron Pinkas <Ron in xHarbour.com>
  * source/vm/classes.c
    ! Corrected hb_objGetOpOver() to use hb_objClassH()
  * source/vm/hvm.c
    + Added support for operator overloading of native types.
  * tests/associat.prg
    + Added sample of operator overloading for numerics

2005-08-29 10:16 UTC-0800 Ron Pinkas <Ron in xHarbour.com>
  *  source/vm/hvm.c
     ! Fixed 2 minor bugs in hb_vmSend() related to Hash method calls
       using Hash:Method( <params> ) syntax

2005-08-28 16:30 UTC-0300 Walter Negro <anegro-AT-overnet.com.ar>
  * source/vm/hbserv.c
  * source/vm/hvm.c
    * Modification to avoid link hbverv code allways.
  * source/vm/eval.c
    ! Fix bug calling hb_execarray() with array and codeblock.
  * source/vm/asort.c
    ! Lock pivot item.

2005-08-25 09:00 UTC+1200 Peter Rees <peter(AT)rees.co.nz>
  * tests/testw32p.prg
    + added ( commented ) sample of TextOutFont() & MM_TOPOSX/Y()

2005-08-24 09:45 UTC+1200 Peter Rees <peter(AT)rees.co.nz>
  * source/rtl/win32prn.prg
    + METHOD MM_TO_POSX( nMm )  Conversion methods from mm on page
    + METHOD MM_TO_POSY( nMm )  to col or row position.
    + METHOD INCH_TO_POSX( nInch ) Conversion methods from Inch on page
    + METHOD INCH_TO_POSY( nInch ) to col or row position.
    + METHOD TextAtFont()       Print at pos in specified font & color
    + METHOD SetBkMode( nMode ) Set background print mode
    - Remove xxxAPI() METHODS added in previous post

2005-08-23 12:40 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * xharbour/include/hbapirdd.h
    * changed {SELF|SUPER}_RECNO( AREAP, PHB_ITEM ) to
      {SELF|SUPER}_RECNO( AREAP, ULONG *)
    + added {SELF|SUPER}_RECID( AREAP, PHB_ITEM )
    + added {SELF|SUPER}_LOCATE( AREAP, BOOL fContinue ) for
      LOCATE/CONTINUE implementation on RDD level - it allows to
      speedup these operation by RDD and resolve the problem with
      external FOUND flag update
    * changed {SELF|SUPER}_UNLOCK( AREAP, ULONG ) to
      {SELF|SUPER}_UNLOCK( AREAP, PHB_ITEM ) - CL5.3 compatible.
      It was the last functions when record number was used directly.
      Now we can create full functional RDD with non numeric record IDs
    + added fBackword and fOptimized fields to DBSCOPEINFO for RDDs
      which may want to mark optimization status
    + added fOptimized to DBFILTERINFO (as above)
    + added isOptimized to DBRELINFO for RDDs which may want to mark
      that relation is optimized on server side. It greatly simplify
      relation implementation which can be resolved on both server and
      xHarbour side and be set between differ RDD work areas.
    + added PHB_ITEM abBlock to DBEVALINFO for RDD which may want to
      pass given codeblock as string to server and evaluate it on
      server side


  * xharbour/include/classes.h
    * small casting fixes for pedantic C++ compilers

  * xharbour/include/dbinfo.ch
    + added DBOI_BAGORDER (number of first order in a bag) for some
      SIX3 sx_*() functions emulation.
    + added DBOI_ISREINDEX, DBOI_I_BAGNAME, DBOI_I_TAGNAME (also SIX3)

  * xharbour/include/hbdefs.h
    ! fix HB_DBL2ORD() macro for -0.0 IEEE754 double conversion to index key

  * xharbour/include/hbrddcdx.h
  * xharbour/include/hbrdddbf.h
  * xharbour/include/hbrdddbt.h
  * xharbour/include/hbrdddel.h
  * xharbour/include/hbrddfpt.h
  * xharbour/include/hbrddntx.h
  * xharbour/include/hbrddsdf.h
  * xharbour/include/hbrddwrk.h
  * xharbour/contrib/rdd_ads/ads1.c
  * xharbour/source/rdd/dbcmd.c
  * xharbour/source/rdd/dbf1.c
  * xharbour/source/rdd/delim1.c
  * xharbour/source/rdd/sdf1.c
  * xharbour/source/rdd/dbfdbt/dbfdbt1.c
  * xharbour/source/rdd/dbffpt/dbffpt1.c
  * xharbour/source/rdd/dbfcdx/dbfcdx1.c
  * xharbour/source/rdd/dbfntx/dbfntx1.c
  * xharbour/source/rdd/hsx/hsx.c
  * xharbour/source/rdd/workarea.c
    * updated for RDD modifications

  * xharbour/source/rdd/dbcmd.c
    * updated for RDD modifications
    * __DBLOCATE() and __DBCONTINUE() now use SELF_LOCATE() method
      (in SELF_SETLOCATE() now also other DBSCOPEINFO fields are set)
    * DBORDERINF() now also to pass ordbag parameter as number - necessary
      for SIX3 emulation in some functions.

  * xharbour/source/rdd/workarea.c
    * updated for RDD modifications
    + added default WA LOCATE() method
    ! fixed dangerous code (possible memory corruption on reentrance)
      in CLEARREL() method

2005-08-23 16:00 UTC+1200 Peter Rees <peter(AT)rees.co.nz>
  * source/rtl/win32prn.prg
    ! METHOD Box(), altered to also support Rounded Rectangles

2005-08-21 23:59 UTC-0300 Eduardo Fernandes <modalsist@yahoo.com.br>
  * source/rtl/tbrowse.prg
    + created method DefColorToDisp( oCol:DefColor ) do return default array
      of indexes if any index is out of scope. Clipper compatibility.
    * changed method named DrawARow() to DrawRow() and method named AColInfo()
      to ColInfoArray() for better knowledge. This last was confused with
      ::aColsInfo data.
    * changed defines named o_??? for better management.
      All these changes are made after bug detected when I run tbdemo.prg
      located in clipper\source. The previous version of tbrowse generate
      a run time error if colorblock is called in column that data type is
      not character. The other bug is related to defcolor of columns when
      number of records is smaller than rows.

2005-08-22 09:30 UTC+1200 Peter Rees <peter(AT)rees.co.nz>
  * source/rtl/win32prn.prg
    ! METHOD GetTextWidth(cString), fix width calculation

2005-08-19 11:13 UTC-0800 Ron Pinkas <Ron in xHarbour.com>
  * source/pp/ppcore.c
    * Fixed case of wrong transformation of '[' ']' to '"' '"' when cLastChar is '.' in getExpReal()

2005-08-36 17:20 UTC-0800 Luis Krause Mantilla <lkrausem /*at*/ shaw /*dot*/ ca>
  * source/rtl/hblog.prg
    ! Fixed problem in which oldest log file wasn't being erased when maximum
      number of backup files was reached.  Posting on behalf of Brian Hays.

2005-08-16 21:35 UTC+0200 Lorenzo Fiorini <lorenzo_fiorini/at/teamwork.it>
  * xharbour/include/gtinfo.ch
    * added GTI_XCURSORCOLOR1, GTI_XCURSORCOLOR2, GTI_XCURSORBLINKRATE
    * Under gtxwc cursor is a "colored" character, these settings help to
    * make it more visible.
  * xharbour/source/rtl/gtxwc.c
    * moved cursor blinking code to hb_xvt_gtProcessMessages
    * added logic to control cursor color and blink rate

2005-08-16 14:50 UTC-0300 Walter Negro <anegro-AT-overnet.com.ar>
  * source/vm/classes.c
    ! Fix bug in __CLSNEW.
      Reported by Phil Krylov.
